@page "/Manager/ManageBookings"
@model HRS_SmartBooking.Pages.Manager.ManageBookingsModel
@{
    ViewData["Title"] = "Manage Bookings";
}

<section class="manager-section">
    <header class="manager-header">
        <div>
            <p class="eyebrow">Bookings</p>
            <h1>All booking reservations</h1>
            <p>Complete view of all bookings with full details, payment information, and guest information.</p>
        </div>
    </header>

    <form method="get" class="filter-bar">
        <div class="filter-field">
            <label>Status</label>
            <select name="bookingStatus" asp-for="BookingStatus">
                <option value="">All</option>
                <option value="pending">Pending</option>
                <option value="confirmed">Confirmed</option>
                <option value="cancelled">Cancelled</option>
            </select>
        </div>
        <div class="filter-field">
            <label>Payment Status</label>
            <select name="paymentStatus" asp-for="PaymentStatus">
                <option value="">All</option>
                <option value="pending">Pending</option>
                <option value="completed">Completed</option>
                <option value="failed">Failed</option>
            </select>
        </div>
        <div class="filter-field">
            <label>Date</label>
            <input type="date" name="filterDate" asp-for="FilterDate" min="2001-01-01" max="@DateTime.Now.AddYears(10).ToString("yyyy-MM-dd")" />
        </div>
        <div class="filter-field full">
            <label>Search</label>
            <div class="input-icon">
                <i class="bi bi-search"></i>
                <input type="search" name="searchQuery" asp-for="SearchQuery" placeholder="Search by customer name, booking ID, or room" />
            </div>
        </div>
        <button type="submit" class="btn btn-outline-light">Filter</button>
        @if (!string.IsNullOrEmpty(Model.BookingStatus) || !string.IsNullOrEmpty(Model.PaymentStatus) || Model.FilterDate.HasValue || !string.IsNullOrEmpty(Model.SearchQuery))
        {
            <a asp-page="/Manager/ManageBookings" class="btn btn-outline-light">Clear</a>
        }
    </form>

    <div class="data-card table-card">
        <div class="card-header">
            <h2>All Bookings</h2>
            <span class="badge badge-outline">@Model.Bookings.Count entries</span>
        </div>
        <div class="responsive-table">
            <table>
                <thead>
                    <tr>
                        <th>Booking ID</th>
                        <th>Customer</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Room</th>
                        <th>Check-in</th>
                        <th>Check-out</th>
                        <th>Guests</th>
                        <th>Total Price</th>
                        <th>Payment Method</th>
                        <th>Payment Status</th>
                        <th>Booking Status</th>
                        <th>Created</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var booking in Model.Bookings)
                    {
                        <tr>
                            <td><strong>@booking.BookingId</strong></td>
                            <td>@booking.CustomerName</td>
                            <td>@booking.Email</td>
                            <td>@booking.Phone</td>
                            <td>@booking.RoomType @booking.RoomNumber</td>
                            <td>@booking.CheckIn</td>
                            <td>@booking.CheckOut</td>
                            <td>@booking.NumberOfGuests</td>
                            <td><strong>@booking.TotalPrice</strong></td>
                            <td>@booking.PaymentMethod</td>
                            <td>
                                <span class="status @booking.PaymentStatus.Replace(" ", "").ToLower()">@booking.PaymentStatus</span>
                            </td>
                            <td>
                                <span class="status @booking.BookingStatus.Replace(" ", "").ToLower()">@booking.BookingStatus</span>
                            </td>
                            <td>@booking.CreatedAt</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</section>

